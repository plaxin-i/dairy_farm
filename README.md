## Описание проекта
Вы работаете в IT-компании, которая выполняет на заказ проекты по машинному обучению. К вам обратился фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».  
Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже. А продавцы и технологи так и норовят приукрасить своих коровок!  
Поэтому он просит вас разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. «ЭкоФерма» готова предоставить подробные данные о своих коровах. Вам нужно создать две прогнозные модели для отбора бурёнок в поголовье:  
- Первая будет прогнозировать возможный удой коровы (целевой признак Удой);  
- Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока).  

С помощью модели нужно отобрать коров по двум критериям:
- средний удой за год — не менее 6000 килограммов;
- молоко должно быть вкусным.
## Ход исследования и выводы  
В ходе выполнения работы были исследованы данные о коровах фермера, именах быков отцов и коровах для покупки.  
  
**Выполнили предобработку данных:**  
- Названия столбцов датафреймов приведены к "змеиному регистру".  
- В ferma_main и ferma_dad были обнаружены полные и неявные дубликаты. Неявные дубликаты были исправлены;
- Типы данных в датафреймах приведены в соответствие.  
  
**Произвели исследовательский анализ:**  
  
  Данные основного датафрейма показали следующее:  
  - Имелся выброс с аномально высоким значением. Удалили строку с этим выбросом. Удои распределены нормально. Медианный удой 6132.5 кг в год.
  - График ЭКЕ смещен в право, медианное значение 14.7.
  - СПО распределенно довольно неравномерно на 2 части с высоким соотношением больше 0.92 и низким меньше этого значения. Медианное значение при этом 0.93
  - График жирности сильно смещен вправо, что говорит о высокой жирности молока. Медианное значение при этом 3.65%. Имеются выбросы слева.
  - Содержание белка в молоке распределено нормально, медианное значение 3.076.
  - Порода вис бик айдиал преобладает в хозяйстве.
  - Холмистые пастбища преобладают в хозяйстве.
  - Породы отцов распределены в равных долях.
  - Молоко с оценкой "вкусно" преобладет (58,9%), хоть и не колоссально.
  - Коров старше 2 лет подавляющее большинство.  
  
Выяснили, что в хозяйстве преобладают коровы старше 2 лет, дающие зачастую вкусное молоко с высокой жирностью и неплохим содержанием белка, около 6000 кг в год.  
  
Данные датафрейма быков пап показали следующее:  
  
Наиболее плодовитыми являются быки по кличке Буйный и Барин с приблизительно равными долями, в 34.2% и 38.2%.  
  
Данные датафрейма коров к покупке показали:  
  - Схожую ситуацию с коровами в хозяйстве с медианной жирностью 3.59%
  - Наблюдаем смещение графика вправо, что говорит о преобладании среднего белка в молоке у коров для покупки. Медианное значение при этом схожее 3.074.
  - Породы коров к покупке как и типы пастбищ, здесь имеют противоположные доли нежели в хозяйстве.
  - Так же и с продами пап быков иная ситуация: Буйный и Геркулес занимают большую долю.
  - С возрастом коров, ситуация аналогична той, что в хозяйстве.  
  
Выяснили, что среди коров к покупке так же большинство старше 2 лет, имеют схожие показатели по жирности и содержанию белка, но при этом чаще пасутся они на равнинах и преобладающая порода здесь рефлешн соверинг.  
  
**Выполнили корреляционный анализ, который показал следующее:**  
  
- ЭКЕ обладает нелинейной зависимостью с удоем, так как линия вокруг которой собраны точки кривая. Для усиления степени связи ЭКЕ придется возвести в квадрат.
- У коров младше 2 лет практически не бывает высокого СПО.  
- СПО при удоях менее 6000 ниже 0.91, значит можно разбить этот признак на категориальный: "менее 0.91" и "более 0.91".  
- Жирность у высокопроизводительных коров (свыше 6000 кг в год) более 3.6 %.
- Коровы порода отца у которых айдиал, чаще имеют болшие показатели удоя.
- Немногие самые высокие показатели удоя (свыше 7000 кг в год) приходят с холмистых пастбищ.
- Линейной зависимости между показателем содержания белка и годового удоя нет.

**Обучили 3 модели линейной регресии**  
  В ходе чего для выявления лучшей модели выполнили соедующие этапы:  
  - Заменили показатель ЭКЕ на ЭКЕ в квадрате для усиления связи с целевым признаком.
  - Добавили категорианальный показатель СПО (spr_cat), так как значение 0.91 делит значения целевого показателя на 2 части.
  - Добавили признак имени папы из таблицы с коровами на продажу.  
  - Убрали признак породы, чтобы снизить влияние на прогнозируемые значения, так как у этого признака практически отсутствовала корреляция с целевым признаком.  
  

С помощью лучшей модели спрогнозировали удой среди коров к покупке, который показал, что из 20 коров к покупке по критерию удоя более 6000 кг в год и не превышающих доверительного интервала подходят 7 коров.   

**Обучили модель логистической регресии**  
  Для улучшения этой модели вычислили и установили порог классификации 0.81 при котором метрика precision стала равна 1, что так же свело False Positive ошибки к нулю.
  С помощью этой модели спрогнозировали вкусовые качества молока у коров к покупке и получили, что 5 коров с высокой степенью уверености дают вкусное молоко. 

  На основе полученных данных с двух моделей получил датафрейм с рекомендациями, из него выделил 4 коровы рекомендуемвх к прокупке с id: 3, 5, 10, 17.
  
